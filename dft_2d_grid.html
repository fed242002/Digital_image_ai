<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkulator DFT 2D (Grid Input)</title>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 20px; background-color: #f8f9fa; color: #333; }
        .container { background-color: #fff; padding: 25px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); max-width: 900px; margin: auto; }
        nav { text-align: center; margin-bottom: 20px; font-size: 1.2em; }
        nav a { text-decoration: none; color: #007BFF; padding: 5px 10px; border-radius: 5px; }
        nav a.active { font-weight: bold; background-color: #007BFF; color: white; }
        h1, h2 { text-align: center; color: #0056b3; border-bottom: 2px solid #0056b3; padding-bottom: 10px; margin-bottom: 20px; }
        label { font-weight: bold; font-size: 1.1em; margin-right: 10px;}
        .grid-controls { margin-bottom: 15px; display: flex; align-items: center; gap: 15px; }
        .grid-controls input[type="number"] { width: 60px; padding: 8px; font-size: 1em; border: 1px solid #ccc; border-radius: 4px; }
        .grid-controls button { padding: 8px 15px; font-size: 1em; background-color: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer; }
        #grid-container table { border-collapse: collapse; margin: 10px 0; }
        #grid-container input { width: 50px; text-align: center; padding: 5px; font-size: 1em; border: 1px solid #ddd; }
        button#calculate-btn { display: block; width: 100%; padding: 12px; margin-top: 15px; background-color: #007BFF; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 18px; }
        .steps { border: 1px solid #e0e0e0; padding: 20px; margin-top: 20px; border-radius: 4px; background-color: #fdfdfd; max-height: 400px; overflow-y: auto; }
        .result-table table { border-collapse: collapse; margin: 20px auto; }
        .result-table th, .result-table td { border: 1px solid #ddd; padding: 8px 12px; text-align: center; }
        .result-table th { background-color: #007BFF; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <nav>
            <a href="dft_2d_grid.html" class="active">DFT 2D</a> | 
            <a href="idft_2d_grid.html">IDFT 2D</a>
        </nav>
        <h1>Kalkulator DFT 2D: Spasial ke Frekuensi</h1>
        <div class="input-section">
            <div class="grid-controls">
                <label for="rows">Baris (M):</label><input type="number" id="rows" value="2" min="1">
                <label for="cols">Kolom (N):</label><input type="number" id="cols" value="2" min="1">
                <button onclick="generateGrid()">Buat/Ubah Grid</button>
            </div>
            <label>Masukkan nilai f(x,y) pada grid:</label>
            <div id="grid-container"></div>
            <p>Rumus: $$ F(u,v) = \sum_{x=0}^{M-1} \sum_{y=0}^{N-1} f(x,y) \cdot e^{-i 2\pi (\frac{ux}{M} + \frac{vy}{N})} $$</p>
            <button id="calculate-btn" onclick="calculate2D_DFT()">Hitung DFT 2D</button>
        </div>
        <div class="output-section">
            <h2>Langkah-langkah Perhitungan:</h2>
            <div id="calculation-steps" class="steps"></div>
        </div>
        <div class="output-section">
            <h2>Hasil F(u,v) Spektrum Frekuensi:</h2>
            <div id="dft-results" class="result-table"></div>
        </div>
    </div>
    <script>
        function generateGrid() {
            const M = parseInt(document.getElementById('rows').value);
            const N = parseInt(document.getElementById('cols').value);
            const container = document.getElementById('grid-container');
            let table = '<table>';
            for (let i = 0; i < M; i++) {
                table += '<tr>';
                for (let j = 0; j < N; j++) {
                    // Contoh nilai awal
                    const sampleValue = (i + j) % 4 + 1;
                    table += `<td><input type="text" id="cell-${i}-${j}" value="${sampleValue}"></td>`;
                }
                table += '</tr>';
            }
            table += '</table>';
            container.innerHTML = table;
        }

        function readGrid() {
            const M = parseInt(document.getElementById('rows').value);
            const N = parseInt(document.getElementById('cols').value);
            let matrix = [];
            for (let i = 0; i < M; i++) {
                let row = [];
                for (let j = 0; j < N; j++) {
                    const val = parseFloat(document.getElementById(`cell-${i}-${j}`).value);
                    row.push(isNaN(val) ? 0 : val);
                }
                matrix.push(row);
            }
            return matrix;
        }

        function calculate2D_DFT() {
            const fxy = readGrid();
            const M = fxy.length;
            const N = fxy[0].length;
            
            const stepsContainer = document.getElementById('calculation-steps');
            const resultsContainer = document.getElementById('dft-results');
            stepsContainer.innerHTML = 'Menghitung...';
            resultsContainer.innerHTML = '';
            
            let fullStepsHtml = '';
            let Fu_v = Array(M).fill(0).map(() => Array(N));

            for (let u = 0; u < M; u++) {
                for (let v = 0; v < N; v++) {
                    let sumReal = 0;
                    let sumImag = 0;
                    
                    for (let x = 0; x < M; x++) {
                        for (let y = 0; y < N; y++) {
                            const angle = -2 * Math.PI * ((u * x / M) + (v * y / N));
                            sumReal += fxy[x][y] * Math.cos(angle);
                            sumImag += fxy[x][y] * Math.sin(angle);
                        }
                    }
                    
                    Fu_v[u][v] = { re: sumReal, im: sumImag };
                    
                    fullStepsHtml += `<div class="step">
                        <h4>\\(F(${u},${v})\\)</h4>
                        <p>$$ F(${u},${v}) = \\sum_{x,y} f(x,y) e^{-i 2\\pi (\\frac{${u}x}{${M}} + \\frac{${v}y}{${N}})} = ${sumReal.toFixed(2)} + i(${sumImag.toFixed(2)}) $$</p>
                    </div>`;
                }
            }
            stepsContainer.innerHTML = fullStepsHtml;
            
            let tableHtml = '<table><thead><tr><th>u\\v</th>';
            for (let v = 0; v < N; v++) tableHtml += `<th>${v}</th>`;
            tableHtml += '</tr></thead><tbody>';

            for (let u = 0; u < M; u++) {
                tableHtml += `<tr><th>${u}</th>`;
                for (let v = 0; v < N; v++) {
                    const val = Fu_v[u][v];
                    const real = val.re.toFixed(2);
                    const imag = val.im.toFixed(2);
                    let displayStr = `${real}`;
                    if (Math.abs(imag) > 0.01) {
                         displayStr += (imag >= 0 ? ' + ' : ' - ') + `${Math.abs(imag)}i`;
                    }
                    tableHtml += `<td>\\(${displayStr}\\)</td>`;
                }
                tableHtml += '</tr>';
            }
            tableHtml += '</tbody></table>';
            resultsContainer.innerHTML = tableHtml;

            if (window.MathJax) MathJax.typesetPromise();
        }

        window.onload = generateGrid;
    </script>
</body>
</html>